// Create loads for standard IEEE test model

clock {
    timezone "PST+8PDT";
    starttime "2020-01-01 00:00:00 PST";
    stoptime "2020-01-02 00:00:00 PST";
}
#set minimum_timestep=3600

//
// Original network model
//
module powerflow 
{
    solver_method NR;
    line_limits FALSE;
    default_maximum_voltage_error 1e-4;
}   

#model get IEEE/13
#include "13.glm"

//
// Top-level object recording
//
module tape
{
    csv_header_type NAME;
}

#define TARGET_NAME=Reg1
#define TARGET_PROPERTIES=power_out

object recorder
{
    parent "${TARGET_NAME}";
    file ${modelname/.glm/.csv};
    property "${TARGET_PROPERTIES}";
    interval -1;
}

//
// Create load models
//
#write ${modelname/.glm/.json}
#python -m create_loads -i=${modelname/.glm/.json} -o=${modelname/.glm/_opt.glm} HOUSE_PROPERTIES='floor_area:random.triangle(1000,2000);gas_enduses:WATERHEATER|DRYER'
#include ${modelname/.glm/_opt.glm}

//
// Verify result
//
#ifexists "../${modelname/.glm/.csv}"
#on_exit 0 diff ../${modelname/.glm/.csv} ${modelname/.glm/.csv}
#endif
