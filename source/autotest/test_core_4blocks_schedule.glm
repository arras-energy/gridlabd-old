// test_core_4blocks_schedule.glm tests to see if a 96 unique valued schedule split into 4 blocks places the correct value into property, base_power,
// of the object ZIPload at the correct time.
// Andy Fisher

#set minimum_timestep=1;

module residential {
	implicit_enduses NONE;
}
module tape;
module assert;
module powerflow;



clock{
	timezone PST+8PDT;
	starttime '2000-01-01 00:00:00';
	stoptime '2000-01-02 00:00:00';
}

schedule zip_power {
	block1 {
		0-14 0 * * * 70.0000;
		15-29 0 * * * 70.3175;
		30-44 0 * * * 70.6349;
		45-59 0 * * * 70.9524;
		0-14 1 * * * 71.2698;
		15-29 1 * * * 71.5873;
		30-44 1 * * * 71.9048;
		45-59 1 * * * 72.2222;
		0-14 2 * * * 72.5397;
		15-29 2 * * * 72.8571;
		30-44 2 * * * 73.1746;
		45-59 2 * * * 73.4921;
		0-14 3 * * * 73.8095;
		15-29 3 * * * 74.1270;
		30-44 3 * * * 74.4444;
		45-59 3 * * * 74.7619;
		0-14 4 * * * 75.0794;
		15-29 4 * * * 75.3968;
		30-44 4 * * * 75.7143;
		45-59 4 * * * 76.0317;
		0-14 5 * * * 76.3492;
		15-29 5 * * * 76.6667;
		30-44 5 * * * 76.9841;
		45-59 5 * * * 77.3016;
	}
	block2 {
		0-14 6 * * * 77.6190;
		15-29 6 * * * 77.9365;
		30-44 6 * * * 78.2540;
		45-59 6 * * * 78.5714;
		0-14 7 * * * 78.8889;
		15-29 7 * * * 79.2063;
		30-44 7 * * * 79.5238;
		45-59 7 * * * 79.8413;
		0-14 8 * * * 80.1587;
		15-29 8 * * * 80.4762;;
		30-44 8 * * * 80.7937;
		45-59 8 * * * 81.1111;
		0-14 9 * * * 81.4286;
		15-29 9 * * * 81.7460;
		30-44 9 * * * 82.0635;
		45-59 9 * * * 82.3810;
		0-14 10 * * * 82.6984;
		15-29 10 * * * 83.0159;
		30-44 10 * * * 83.3333;
		45-59 10 * * * 83.6508;
		0-14 11 * * * 83.9683;
		15-29 11 * * * 84.2857;
		30-44 11 * * * 84.6032;
		45-59 11 * * * 84.9206;
	}
	block3 {
		0-14 12 * * * 85.2381;
		15-29 12 * * * 85.5556;
		30-44 12 * * * 85.8730;
		45-59 12 * * * 86.1905;
		0-14 13 * * * 86.5079;
		15-29 13 * * * 86.8254;
		30-44 13 * * * 87.1429;
		45-59 13 * * * 87.4603;
		0-14 14 * * * 87.7778;
		15-29 14 * * * 88.0952;
		30-44 14 * * * 88.4127;
		45-59 14 * * * 88.7302;
		0-14 15 * * * 89.0476;
		15-29 15 * * * 89.3651;
		30-44 15 * * * 89.6825;
		45-59 15 * * * 89.9;
		0-14 16 * * * 90.2;
		15-29 16 * * * 90.5;
		30-44 16 * * * 90.8;
		45-59 16 * * * 91.1;
		0-14 17 * * * 91.4;
		15-29 17 * * * 91.7;
		30-44 17 * * * 92.0;
		45-59 17 * * * 92.3;
	}
	block4 {
		0-14 18 * * * 92.6;
		15-29 18 * * * 92.9;
		30-44 18 * * * 93.2;
		45-59 18 * * * 93.5;
		0-14 19 * * * 93.8;
		15-29 19 * * * 94.1;
		30-44 19 * * * 94.4;
		45-59 19 * * * 94.7;
		0-14 20 * * * 95.0;
		15-29 20 * * * 95.3;
		30-44 20 * * * 95.6;
		45-59 20 * * * 95.9;
		0-14 21 * * * 96.2;
		15-29 21 * * * 96.5;
		30-44 21 * * * 96.8;
		45-59 21 * * * 97.1;
		0-14 22 * * * 97.4;
		15-29 22 * * * 97.7;
		30-44 22 * * * 98.0;
		45-59 22 * * * 98.3;
		0-14 23 * * * 98.6;
		15-29 23 * * * 98.9;
		30-44 23 * * * 99.2;
		45-59 23 * * * 99.5;
	}
}

	

object triplex_meter {
	name PHASE_A;
	phases AS;
	nominal_voltage 120;
	object house {
		object ZIPload {
			heat_fraction 1;
			base_power zip_power*1+1;		
			power_pf 1;
			power_fraction 1;
			current_pf 0;
			current_fraction 0;
			impedance_pf 0;
			impedance_fraction 0;
			object recorder{
				property base_power;
				file "base_power.csv";
				interval 900;
				limit 96;
			};
			object double_assert{
				target base_power;
				status ASSERT_TRUE;
				within 1e-4;
				object player{
					property value;
					file "../test_core_4blocks_schedule.player";
					loop 1;
				};
			};
		};
	};
}